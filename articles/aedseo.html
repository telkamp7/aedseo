<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="aedseo">
<title>Automated and Early Detection of Seasonal Epidemic Onset â€¢ aedseo</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Automated and Early Detection of Seasonal Epidemic Onset">
<meta property="og:description" content="aedseo">
<meta property="og:image" content="https://telkamp7.github.io/aedseo/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">aedseo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/aedseo.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/aedseo_introduction.html">Automated Detection of Seasonal Epidemic Onset in R</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/telkamp7/aedseo/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="aedseo_files/kePrint-0.0.1/kePrint.js"></script><link href="aedseo_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Automated and Early Detection of Seasonal Epidemic Onset</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/telkamp7/aedseo/blob/HEAD/vignettes/articles/aedseo.Rmd" class="external-link"><code>vignettes/articles/aedseo.Rmd</code></a></small>
      <div class="d-none name"><code>aedseo.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/telkamp7/aedseo" class="external-link">aedseo</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ISOweek</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">kableExtra</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'kableExtra'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     group_rows</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Understanding the seasonality of respiratory virus infections is
crucial for countries to make informed recommendations concerning the
timing of monoclonal antibody provision, particularly for the treatment
and prophylaxis of children exposed to respiratory syncytial virus (RSV)
in their first year(s) of life, primarily premature infants <span class="citation">Teirlinck et al. (2023)</span>. Moreover, the timely
detection of epidemic onset has the potential to guide empirical
antiviral therapy for hospitalized patients with suspected influenza
<span class="citation">(McGeer 2009)</span>. This, in turn, contributes
to the reduction of the health an economic burden caused by respiratory
virus infections. Achieving accurate identification of the beginning of
seasonal respiratory epidemics necessitates regular and prompt data
collection, coupled with a standardized procedure for continuous data
analysis.</p>
<p>A wide range of statistical methods are at out disposal for defining
influenza epidemics. Over the last two decades, techniques such as
Serfling-based models and dynamic linear models, which rely on recent
data <span class="citation">Pelat et al. (2007)</span>, have been
extensively employed for this purpose.</p>
<p>This package revolves around the timely detection of the onset of
seasonal respiratory epidemics.</p>
</div>
<div class="section level2">
<h2 id="methodology">Methodology<a class="anchor" aria-label="anchor" href="#methodology"></a>
</h2>
<p>The methodology used to detect the onset of seasonal respiratory
epidemics can be divided into two essential criteria:</p>
<ul>
<li>The local estimate of the exponential growth rate, <span class="math inline">\(r\)</span>, is significantly greater than
zero.</li>
<li>The sum of cases (SoC) over the past <span class="math inline">\(k\)</span> units of time exceeds a
disease-specific threshold.</li>
</ul>
<p>Here, <span class="math inline">\(k\)</span> denotes the window size
employed to obtain the local estimate of the exponential growth rate and
the SoC. When both of these criteria are met, an alarm is triggered and
the onset of the seasonal epidemic is detected.</p>
<div class="section level3">
<h3 id="exponential-growth-rate">Exponential growth rate<a class="anchor" aria-label="anchor" href="#exponential-growth-rate"></a>
</h3>
<p>Inspired by <span class="citation">Obadia, Haneef, and Boelle
(2012)</span></p>
<p>The exponential growth rate, denoted as <span class="math inline">\(r\)</span>, represents the per capita change in
the number of new cases per unit of time. Given that incidence data are
integer-valued, the proposed method relies on generalized linear models
(GLM). For count data, the Poisson distribution is a suitable choice as
a model. Hence, the count observations denoted as <span class="math inline">\(Y\)</span> are assumed to follow a Poisson
distribution</p>
<p><span class="math display">\[\begin{equation}
Y \sim \Pois(\lambda)
\end{equation}\]</span></p>
<p>Here, the link function, <span class="math inline">\(\log()\)</span>,
connects the linear predictor to the expected value of the data point,
expressed as <span class="math inline">\(\log(\lambda)=\mu\)</span>.
Given a single continuous covariate <span class="math inline">\(t\)</span>, the mean <span class="math inline">\(\mu\)</span> can be expressed as</p>
<p><span class="math display">\[\begin{equation}
  \mu = \alpha + r t
\end{equation}\]</span></p>
<p>This is equivalent to a multiplicative model for <span class="math inline">\(\lambda\)</span>, i.e.</p>
<p><span class="math display">\[\begin{equation}
  \lambda = \exp(\alpha + r t) = \exp(\alpha) \exp(r t)
\end{equation}\]</span></p>
<p>Intuitively, negative values of <span class="math inline">\(r\)</span> result in a decline in the number of
observed cases, while <span class="math inline">\(r=0\)</span>
represents stability, and positive values of <span class="math inline">\(r\)</span> indicate an increase. The direct
relationship between growth rates and reproductive numbers is further
elaborated in the study by <span class="citation">Wallinga and Lipsitch
(2007)</span>.</p>
<p>It is important to note that the Poisson distribution assumes that
the mean and variance are equal. In reality, real data often deviate
from this assumption, with the variance (<span class="math inline">\(v\)</span>) being significantly larger than the
mean. This biological phenomenon, known as overdispersion, can be
addressed within a model in various ways. One approach is to employ
quasi-Poisson regression, which assumes <span class="math inline">\(v=\sigma\lambda\)</span>, or to use negative
binomial regression, which assumes <span class="math inline">\(v=\lambda+\lambda^2/\theta\)</span>, where both
<span class="math inline">\(\sigma\)</span> and <span class="math inline">\(\theta\)</span> are overdispersion parameters.</p>
</div>
</div>
<div class="section level2">
<h2 id="simulations">Simulations<a class="anchor" aria-label="anchor" href="#simulations"></a>
</h2>
<p>To assess the effectiveness of the proposed algorithm, a simulation
study is conducted. The simulated data is generated using a negative
binomial model with a mean parameter <span class="math inline">\(\mu\)</span> and a variance parameter <span class="math inline">\(\phi\mu\)</span>. In this context, <span class="math inline">\(\phi\)</span> denotes a dispersion parameter,
which is assumed to be greater than or equal to 1. The mean, denoted as
<span class="math inline">\(\mu(t)\)</span>, is defined by a linear
predictor that incorporates both a trend component and a seasonality
components represented by Fourier terms. The equation for <span class="math inline">\(\mu(t)\)</span> is as follows:</p>
<p><span class="math display">\[\begin{equation}
  \mu(t) = \exp\Biggl( \theta + \beta t + \sum_{j=1}^m \biggl(
\gamma_{\sin} \sin\Bigl( \frac{2 \pi t}{52}\Bigl) + \gamma_{\cos} \cos
\Bigl( \frac{2 \pi t}{52} \Bigl) \biggl) \Biggl)
\end{equation}\]</span></p>
<p>To accommodate a variety of scenarios encountered in practical
applications, the simulations is generated using different combinations
of parameters. These parameters include baseline frequencies of reports
denoted as <span class="math inline">\(\theta\)</span>, trends
represented by <span class="math inline">\(\beta\)</span>, seasonal
patterns characterized by <span class="math inline">\(\gamma_{\sin}\)</span> and <span class="math inline">\(\gamma_{\cos}\)</span>, as well as dispersions
indicated by <span class="math inline">\(\phi\)</span>. A list of the
specific parameter combinations are provided in Table XX.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># TODO: #7 Conduct the simulation study and write the article on the `aedseo`</span></span>
<span><span class="co"># package. @telkamp7</span></span>
<span><span class="va">parameter_combinations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span></span>
<span>  theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span><span class="op">)</span>,</span>
<span>  beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.001</span><span class="op">)</span>,</span>
<span>  gamma_sin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  gamma_cos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  phi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">parameter_combinations</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Scenario <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/row_number.html" class="external-link">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Scenario</span>, <span class="va">theta</span><span class="op">:</span><span class="va">phi</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span></span>
<span>    `$\\theta$` <span class="op">=</span> <span class="va">theta</span>,</span>
<span>    `$\\beta$` <span class="op">=</span> <span class="va">beta</span>,</span>
<span>    `$\\gamma_{\\sin}$` <span class="op">=</span> <span class="va">gamma_sin</span>,</span>
<span>    `$\\gamma_{\\cos}$` <span class="op">=</span> <span class="va">gamma_cos</span>,</span>
<span>    `$\\phi$` <span class="op">=</span> <span class="va">phi</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html" class="external-link">kbl</a></span><span class="op">(</span></span>
<span>    booktabs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    escape <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    align <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Parameters and criteria to generate the 40 scenarios."</span>,</span>
<span>    linesep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">""</span>, <span class="fl">7</span><span class="op">)</span>, <span class="st">"\\addlinespace"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_classic.html" class="external-link">kable_paper</a></span><span class="op">(</span>latex_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HOLD_position"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table  lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
<caption>
Parameters and criteria to generate the 40 scenarios.
</caption>
<thead><tr>
<th style="text-align:left;">
Scenario
</th>
<th style="text-align:left;">
<span class="math inline">\(\theta\)</span>
</th>
<th style="text-align:left;">
<span class="math inline">\(\beta\)</span>
</th>
<th style="text-align:left;">
<span class="math inline">\(\gamma_{\sin}\)</span>
</th>
<th style="text-align:left;">
<span class="math inline">\(\gamma_{\cos}\)</span>
</th>
<th style="text-align:left;">
<span class="math inline">\(\phi\)</span>
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
14
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
15
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
16
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
17
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
18
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
19
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
20
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
21
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
22
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
23
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
24
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
25
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
26
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
27
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
28
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
29
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
30
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
31
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
32
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
33
</td>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
34
</td>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
35
</td>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
36
</td>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
37
</td>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
38
</td>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
39
</td>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
40
</td>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
0.001
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu_t</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>    <span class="va">t</span>,</span>
<span>    <span class="va">theta</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="va">exp_beta</span> <span class="op">=</span> <span class="fl">1.001</span>,</span>
<span>    <span class="va">gamma_sin</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="va">gamma_cos</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="va">trend</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="va">j</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Start construction of linear predictor</span></span>
<span>  <span class="va">linear_predictor</span> <span class="op">&lt;-</span> <span class="va">theta</span></span>
<span>  <span class="co"># ... add a trend if the scenario request it</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">trend</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">linear_predictor</span> <span class="op">&lt;-</span> <span class="va">linear_predictor</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">exp_beta</span><span class="op">)</span> <span class="op">*</span> <span class="va">t</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="co"># ... add a seasonal component</span></span>
<span>  <span class="va">linear_predictor</span> <span class="op">&lt;-</span> <span class="va">linear_predictor</span> <span class="op">+</span></span>
<span>    <span class="va">gamma_sin</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">t</span> <span class="op">*</span> <span class="va">j</span> <span class="op">/</span> <span class="fl">52</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">gamma_cos</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">t</span> <span class="op">*</span> <span class="va">j</span> <span class="op">/</span> <span class="fl">52</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">linear_predictor</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">simulate_from_nbinom</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Set some default values for the simulation</span></span>
<span>  <span class="va">default_pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"t"</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="st">"theta"</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="st">"exp_beta"</span> <span class="op">=</span> <span class="fl">1.001</span>,</span>
<span>    <span class="st">"gamma_sin"</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="st">"gamma_cos"</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="st">"trend"</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="st">"j"</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="st">"phi"</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="st">"seed"</span> <span class="op">=</span> <span class="fl">42</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Match call</span></span>
<span>  <span class="va">mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/match.call.html" class="external-link">match.call</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="co"># ... and change parameters relative to the call</span></span>
<span>  <span class="va">index_mc</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">default_pars</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mc</span><span class="op">)</span></span>
<span>  <span class="va">mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">mc</span>, <span class="va">default_pars</span><span class="op">[</span><span class="va">index_mc</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">default_pars</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># Set the seed</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">mc</span><span class="op">$</span><span class="va">seed</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Calculate the number of time points</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/eval.html" class="external-link">eval</a></span><span class="op">(</span><span class="va">mc</span><span class="op">$</span><span class="va">t</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="co"># Calculate mu_t</span></span>
<span>  <span class="va">mu_t_scenario</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"mu_t"</span>, args <span class="op">=</span> <span class="va">mc</span><span class="op">)</span></span>
<span>  <span class="co"># ... and compute the variance of the negative binomial distribution</span></span>
<span>  <span class="va">variance</span> <span class="op">&lt;-</span> <span class="va">mu_t_scenario</span> <span class="op">*</span> <span class="va">mc</span><span class="op">$</span><span class="va">phi</span></span>
<span>  <span class="co"># ... and infer the size in the negative binomial distribution</span></span>
<span>  <span class="va">size</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">mu_t_scenario</span> <span class="op">+</span> <span class="va">mu_t_scenario</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="va">variance</span></span>
<span>  <span class="co"># Plugin and simulate the data</span></span>
<span>  <span class="va">simulation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">rnbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, mu <span class="op">=</span> <span class="va">mu_t_scenario</span>, size <span class="op">=</span> <span class="va">size</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"mu_t"</span> <span class="op">=</span> <span class="va">mu_t_scenario</span>, <span class="st">"simulation"</span> <span class="op">=</span> <span class="va">simulation</span>, <span class="st">"pars"</span> <span class="op">=</span> <span class="va">mc</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define the number of years and the number of months within a year</span></span>
<span><span class="va">years</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">weeks</span> <span class="op">&lt;-</span> <span class="fl">52</span></span>
<span><span class="co"># ... calculate the total number of observations</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="va">years</span> <span class="op">*</span> <span class="va">weeks</span></span>
<span><span class="co"># ... and a vector containing the overall time passed</span></span>
<span><span class="va">time_overall</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span></span>
<span><span class="co"># Create arbitrary dates</span></span>
<span><span class="va">dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">time_overall</span> <span class="op">*</span> <span class="fl">86400</span> <span class="op">*</span> <span class="fl">7</span>,</span>
<span>  origin <span class="op">=</span> <span class="st">"2010-01-01"</span>,</span>
<span>  tz <span class="op">=</span> <span class="st">"UTC"</span>,</span>
<span>  format <span class="op">=</span> <span class="st">"%F"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate the data</span></span>
<span><span class="va">simulation</span> <span class="op">&lt;-</span> <span class="fu">simulate_from_nbinom</span><span class="op">(</span>t <span class="op">=</span> <span class="va">time_overall</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Collect the data in a 'tibble'</span></span>
<span><span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  Date <span class="op">=</span> <span class="va">dates</span>,</span>
<span>  mu_t <span class="op">=</span> <span class="va">simulation</span><span class="op">$</span><span class="va">mu_t</span>,</span>
<span>  y <span class="op">=</span> <span class="va">simulation</span><span class="op">$</span><span class="va">simulation</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Have a glance at the time varying mean</span></span>
<span><span class="va">sim_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="va">mu_t</span><span class="op">:</span><span class="va">y</span>, names_to <span class="op">=</span> <span class="st">"type"</span>, values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Date</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span>facets <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">type</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="aedseo_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">sim_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Date</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mu_t</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="aedseo_files/figure-html/unnamed-chunk-3-2.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Construct a 'tsibble' object with the time series data</span></span>
<span><span class="va">tsd_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tsd.html">tsd</a></span><span class="op">(</span></span>
<span>  observed <span class="op">=</span> <span class="va">simulation</span><span class="op">$</span><span class="va">simulation</span>,</span>
<span>  time <span class="op">=</span> <span class="va">dates</span>,</span>
<span>  time_interval <span class="op">=</span> <span class="st">"week"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Apply the 'aedseo' algorithm</span></span>
<span><span class="va">aedseo_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aedseo.html">aedseo</a></span><span class="op">(</span></span>
<span>  tsd <span class="op">=</span> <span class="va">tsd_data</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"quasipoisson"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize the growth rate</span></span>
<span><span class="va">aedseo_results</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">reference_time</span>, y <span class="op">=</span> <span class="va">growth_rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      ymin <span class="op">=</span> <span class="va">lower_growth_rate</span>,</span>
<span>      ymax <span class="op">=</span> <span class="va">upper_growth_rate</span></span>
<span>    <span class="op">)</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.3</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></span></code></pre></div>
<p><img src="aedseo_files/figure-html/unnamed-chunk-3-3.png" width="700"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">aedseo_results</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">reference_time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">growth_rate</span>, alpha <span class="op">=</span> <span class="va">growth_warning</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      ymin <span class="op">=</span> <span class="va">lower_growth_rate</span>,</span>
<span>      ymax <span class="op">=</span> <span class="va">upper_growth_rate</span>,</span>
<span>      alpha <span class="op">=</span> <span class="va">growth_warning</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Using alpha for a discrete variable is not advised.</span></span></code></pre></div>
<p><img src="aedseo_files/figure-html/unnamed-chunk-3-4.png" width="700"></p>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-McGeer_2009" class="csl-entry">
McGeer, Allison J. 2009. <span>â€œ<span class="nocase">Diagnostic Testing
or Empirical Therapy for Patients Hospitalized with Suspected Influenza:
What to Do?</span>â€</span> <em>Clinical Infectious Diseases</em> 48
(Supplement_1): S14â€“19. <a href="https://doi.org/10.1086/591852" class="external-link">https://doi.org/10.1086/591852</a>.
</div>
<div id="ref-Hara_2010" class="csl-entry">
Oâ€™Hara, Robert B., and D. Johan Kotze. 2010. <span>â€œDo Not Log-Transform
Count Data.â€</span> <em>Methods in Ecology and Evolution</em> 1 (2):
118â€“22. https://doi.org/<a href="https://doi.org/10.1111/j.2041-210X.2010.00021.x" class="external-link">https://doi.org/10.1111/j.2041-210X.2010.00021.x</a>.
</div>
<div id="ref-Obadia_2012" class="csl-entry">
Obadia, Thomas, Romana Haneef, and Pierre-Yves Boelle. 2012. <span>â€œThe
R0 Package: A Toolbox to Estimate Reproduction Numbers for Epidemic
Outbreaks.â€</span> <em>BMC Medical Informatics and Decision Making</em>
12. <a href="https://doi.org/10.1186/1472-6947-12-147" class="external-link">https://doi.org/10.1186/1472-6947-12-147</a>.
</div>
<div id="ref-Pelat_2007" class="csl-entry">
Pelat, Camille, Pierre-Yves BoÃ«lle, Benjamin J. Cowling, Fabrice Carrat,
Antoine Flahault, SÃ©verine Ansart, and Alain-Jacques Valleron. 2007.
<span>â€œOnline Detection and Quantification of Epidemics.â€</span> <em>BMC
Medical Informatics and Decision Making</em> 7. <a href="https://doi.org/10.1186/1472-6947-7-29" class="external-link">https://doi.org/10.1186/1472-6947-7-29</a>.
</div>
<div id="ref-Serfling_1963" class="csl-entry">
Serfling, Robert E. 1963. <span>â€œMethods for Current Statistical
Analysis of Excess Pneumonia-Influenza Deaths.â€</span> <em>Public Health
Reports (1896-1970)</em> 78 (6): 494â€“506. <a href="http://www.jstor.org/stable/4591848" class="external-link">http://www.jstor.org/stable/4591848</a>.
</div>
<div id="ref-Stroup_1989" class="csl-entry">
Stroup, Donna F., G. David Williamson, Joy L. Herndon, and John M.
Karon. 1989. <span>â€œDetection of Aberrations in the Occurrence of
Notifiable Diseases Surveillance Data.â€</span> <em>Statistics in
Medicine</em> 8 (3): 323â€“29. https://doi.org/<a href="https://doi.org/10.1002/sim.4780080312" class="external-link">https://doi.org/10.1002/sim.4780080312</a>.
</div>
<div id="ref-Teirlinck_2023" class="csl-entry">
Teirlinck, Anne C., Caroline K. Johannesen, Eeva K. Broberg, Pasi
Penttinen, Harry Campbell, Harish Nair, Rachel M. Reeves, et al. 2023.
<span>â€œNew Perspectives on Respiratory Syncytial Virus Surveillance at
the National Level: Lessons from the COVID-19 Pandemic.â€</span>
<em>European Respiratory Journal</em> 61 (4). <a href="https://doi.org/10.1183/13993003.01569-2022" class="external-link">https://doi.org/10.1183/13993003.01569-2022</a>.
</div>
<div id="ref-Terletskaia_2005" class="csl-entry">
Terletskaia-Ladwig, E, G Enders, G Schalasta, and M Enders. 2005.
<span>â€œDefining the Timing of Respiratory Syncytial Virus (RSV)
Outbreaks: An Epidemiological Study.â€</span> <em>BMC Infectious
Diseases</em> 5. <a href="https://doi.org/10.1186/1471-2334-5-20" class="external-link">https://doi.org/10.1186/1471-2334-5-20</a>.
</div>
<div id="ref-Wallinga_2007" class="csl-entry">
Wallinga, J, and M Lipsitch. 2007. <span>â€œHow Generation Intervals Shape
the Relationship Between Growth Rates and Reproductive Numbers.â€</span>
<em>Proceedings of the Royal Society B: Biological Sciences</em> 274
(1609): 599â€“604. <a href="https://doi.org/10.1098/rspb.2006.3754" class="external-link">https://doi.org/10.1098/rspb.2006.3754</a>.
</div>
<div id="ref-West_1997" class="csl-entry">
West, Mike, and Jeff Harrison. 1997. <em>Bayesian Forecasting and
Dynamic Models (2nd Ed.)</em>. Berlin, Heidelberg: Springer-Verlag.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Kasper Schou Telkamp.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
